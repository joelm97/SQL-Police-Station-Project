CREATE TABLE POLICEMAN
(POLCEMAN_ID CHAR(5) PRIMARY KEY,
POLICEMAN_PHONE CHAR(10),
POLICEMAN_RANK CHAR(15));
INSERT INTO POLICEMAN
VALUES
('A5343','7031231234','OFFICER');
INSERT INTO POLICEMAN
VALUES
('A1234','7034445555','CORPORAL');
INSERT INTO POLICEMAN
VALUES
('A3431','7031112222','SERGEANT');

CREATE TABLE VEHICLE_REGISTRATION
(REGISTRATION_NUM CHAR(10) PRIMARY KEY,
LICENSE_PLATE CHAR(10),
POLICEMAN_ID CHAR(10),
VIN CHAR(10));
INSERT INTO VEHICLE_REGISTRATION
VALUES
('4232TOY','VMD1234','A5343','VINA5343');
INSERT INTO VEHICLE_REGISTRATION
VALUES
('1235HON','DMV5432','A1234','VINA1234');
INSERT INTO VEHICLE_REGISTRATION
VALUES
('9864FOR','MDV9786','A3431','VINA3431');

INSERT INTO VEHICLE_REGISTRATION
VALUES
('3467322','MDC9746','A3431','VINA3430');

CREATE TABLE VEHICLE
(VIN CHAR(10) PRIMARY KEY,
POLICEMAN_ID CHAR(10));
INSERT INTO VEHICLE
VALUES
('VINA5343','A5343');
INSERT INTO VEHICLE
VALUES
('VINA1234','A1234');
INSERT INTO VEHICLE
VALUES
('VINA3431','A3431');

CREATE TABLE POLICE_SERVICE
(SERVICE_TYPE CHAR(20) PRIMARY KEY,
SERVICE_LOCATION CHAR(10),
POLICE_ID CHAR(10));
INSERT INTO POLICE_SERVICE
VALUES
('TRAFFIC_CONTROL','ALEXANDRIA','A5343');
INSERT INTO POLICE_SERVICE
VALUES
('HIGHWAY_PATROL','LEESBURG','A1234');
INSERT INTO POLICE_SERVICE
VALUES
('VOLUNTEER','FAIRFAX','A3431');

CREATE TABLE SERVICE_LENGTH
(SERVICE_TYPE CHAR(10) PRIMARY KEY,
START_DATE DATE,
END_DATE DATE,
POLCEMAN_ID CHAR(10));
INSERT INTO SERVICE_LENGTH
VALUES
('TRAFFIC_CONTROL','2018-01-01','2018-02-01','A5343');
INSERT INTO SERVICE_LENGTH
VALUES
('HIGHWAY_PATROL','2018-01-01','2018-02-01','A1234');
INSERT INTO SERVICE_LENGTH
VALUES
('VOLUNTEER','2018-01-01','2018-02-01','A3431');

CREATE TABLE SERVICE
(SERVICE_NAME CHAR(30) PRIMARY KEY,
SERVICE_TYPE CHAR(30));
INSERT INTO SERVICE
VALUES
('SEMENARY_ROAD_TRAFFIC','TRAFFIC_CONTROL');
INSERT INTO SERVICE
VALUES
('395_PATROL','HIGHWAY_PATROL');
INSERT INTO SERVICE
VALUES
('NEIGHBORHOOD_WATCH','VOLUNTEER');

DROP TABLE POLICEMAN;

DROP TABLE VEHICLE_REGISTRATION;

DROP TABLE VEHICLE;

DROP TABLE POLICE_SERVICE;

DROP TABLE SERVICE_LENGTH;

DROP TABLE SERVICE;


describe POLICEMAN;

describe VEHICLE_REGISTRATION;

describe VEHICLE;

describe POLICE_SERVICE;

describe SERVICE_LENGTH;

describe SERVICE;


SELECT* FROM POLICEMAN;

SELECT* FROM VEHICLE_REGISTRATION;

SELECT* FROM VEHICLE;

SELECT* FROM POLICE_SERVICE;

SELECT* FROM SERVICE_LENGTH;

SELECT* FROM SERVICE;



SELECT VEHICLE_REGISTRATION.REGISTRATION_NUM, VEHICLE_REGISTRATION.LICENSE_PLATE, 
VEHICLE_REGISTRATION.POLICEMAN_ID, VEHICLE_REGISTRATION.VIN
FROM  VEHICLE_REGISTRATION
INNER JOIN
VEHICLE
ON VEHICLE_REGISTRATION.VIN=VEHICLE.VIN
WHERE VEHICLE.VIN = 'VINA1234';



SELECT VEHICLE_REGISTRATION.REGISTRATION_NUM, VEHICLE_REGISTRATION.LICENSE_PLATE, 
VEHICLE_REGISTRATION.POLICEMAN_ID, VEHICLE_REGISTRATION.VIN
FROM  VEHICLE_REGISTRATION
INNER JOIN
VEHICLE
ON VEHICLE_REGISTRATION.VIN=VEHICLE.VIN
WHERE VEHICLE.VIN = 'VINA1234' OR VEHICLE.VIN = 'VINA3431';

SELECT SERVICE_TYPE, SERVICE_LOCATION, POLICE_ID
FROM POLICE_SERVICE
WHERE SERVICE_TYPE IN (SELECT SERVICE_TYPE FROM SERVICE);

SELECT COUNT(REGISTRATION_NUM), LICENSE_PLATE
FROM VEHICLE_REGISTRATION
GROUP BY POLICEMAN_ID
HAVING COUNT(REGISTRATION_NUM) > 1;